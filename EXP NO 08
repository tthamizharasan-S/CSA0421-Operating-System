import threading
import time
import random

# Number of philosophers
num = 5

# Create locks for chopsticks
chopsticks = [threading.Lock() for _ in range(num)]

def philosopher(i):
    while True:
        print(f"Philosopher {i} is thinking.")
        time.sleep(random.uniform(1, 3))  # thinking time

        # pick up left and right chopsticks
        left = i
        right = (i + 1) % num

        # To avoid deadlock, pick lower-numbered chopstick first
        first, second = (left, right) if left < right else (right, left)

        with chopsticks[first]:
            with chopsticks[second]:
                print(f"Philosopher {i} is eating.")
                time.sleep(random.uniform(1, 2))  # eating time
                print(f"Philosopher {i} finished eating and put down chopsticks.")

# Create and start threads
threads = []
for i in range(num):
    t = threading.Thread(target=philosopher, args=(i,))
    threads.append(t)
    t.start()

# Join threads
for t in threads:
    t.join()
